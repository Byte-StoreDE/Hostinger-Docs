<!DOCTYPE HTML>
<html lang="de">
<head>
<!-- Generated by javadoc (17) on Mon Nov 10 13:59:59 CET 2025 -->
<title>TOTPService</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2025-11-10">
<meta name="description" content="declaration: package: de.bytestore.hostinger.security.service, class: TOTPService">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/TOTPService.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">de.bytestore.hostinger.security.service</a></div>
<h1 title="Class TOTPService" class="title">Class TOTPService</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">de.bytestore.hostinger.security.service.TOTPService</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="annotations">@Component
@Service
</span><span class="modifiers">public class </span><span class="element-name type-name-label">TOTPService</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(io.jmix.core.security.SystemAuthenticator)" class="member-name-link">TOTPService</a><wbr>(io.jmix.core.security.SystemAuthenticator&nbsp;systemAuthenticator)</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>dev.samstevens.totp.qr.QrData</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#generateCode(de.bytestore.hostinger.entity.user.User)" class="member-name-link">generateCode</a><wbr>(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Generates a QR code for the given user and adds it to the QR data.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#generateRecoveryCodes(de.bytestore.hostinger.entity.user.User,int)" class="member-name-link">generateRecoveryCodes</a><wbr>(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 int&nbsp;amountIO)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Generates recovery codes for a user.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#generateSecret()" class="member-name-link">generateSecret</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Generates a secret using the secret generator.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getDataUriForImage(dev.samstevens.totp.qr.QrData)" class="member-name-link">getDataUriForImage</a><wbr>(dev.samstevens.totp.qr.QrData&nbsp;codeIO)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Retrieves the data URI for an image generated using the specified <code>codeIO</code> object.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getImageSRC(dev.samstevens.totp.qr.QrData)" class="member-name-link">getImageSRC</a><wbr>(dev.samstevens.totp.qr.QrData&nbsp;codeIO)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Retrieves the image source data of a QR code generated using the specified <code>codeIO</code> object.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getMimeType()" class="member-name-link">getMimeType</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the MIME type of the image generated by the <code>imageGenerator</code>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getRecoveryCodes(de.bytestore.hostinger.entity.user.User)" class="member-name-link">getRecoveryCodes</a><wbr>(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Retrieves the recovery codes associated with a user.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getUserByUsername(java.lang.String)" class="member-name-link">getUserByUsername</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;usernameIO)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Retrieves the user with the given username or email from the database.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#hasRecoveryCode(de.bytestore.hostinger.entity.user.User,java.lang.String)" class="member-name-link">hasRecoveryCode</a><wbr>(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;codeIO)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Checks if the given user has a recovery code.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#hasTOTP(de.bytestore.hostinger.entity.user.User)" class="member-name-link">hasTOTP</a><wbr>(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Checks if the given user has Time-based One-Time Password (TOTP) authentication enabled.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#hasTOTP(java.lang.String)" class="member-name-link">hasTOTP</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;usernameIO)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Checks if a user has Time-based One-Time Password (TOTP) authentication enabled.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#onApplicationStarted(org.springframework.boot.context.event.ApplicationStartedEvent)" class="member-name-link">onApplicationStarted</a><wbr>(org.springframework.boot.context.event.ApplicationStartedEvent&nbsp;event)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../entity/totp/TOTPStorage.html" title="class in de.bytestore.hostinger.security.entity.totp">TOTPStorage</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#save(de.bytestore.hostinger.entity.user.User,dev.samstevens.totp.qr.QrData)" class="member-name-link">save</a><wbr>(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 dev.samstevens.totp.qr.QrData&nbsp;secretIO)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Saves the user's information and secret for Time-based One-Time Password (TOTP) authentication.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#saveRecoveryCodes(de.bytestore.hostinger.entity.user.User,java.lang.String%5B%5D,de.bytestore.hostinger.security.entity.totp.TOTPStorage)" class="member-name-link">saveRecoveryCodes</a><wbr>(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]&nbsp;codesIO,
 <a href="../entity/totp/TOTPStorage.html" title="class in de.bytestore.hostinger.security.entity.totp">TOTPStorage</a>&nbsp;storageIO)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Saves the recovery codes for a user.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#updateVerifier()" class="member-name-link">updateVerifier</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Updates the verifier for Time-based One-Time Password (TOTP) authentication.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#verifyRecoveryCode(de.bytestore.hostinger.entity.user.User,java.lang.String)" class="member-name-link">verifyRecoveryCode</a><wbr>(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;codeIO)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Verifies the recovery code provided by the user.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#verifyTOTP(de.bytestore.hostinger.entity.user.User,java.lang.Integer)" class="member-name-link">verifyTOTP</a><wbr>(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;otpIO)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Verifies the Time-based One-Time Password (TOTP) entered by the user.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#verifyTOTP(de.bytestore.hostinger.entity.user.User,java.lang.Integer,java.lang.String)" class="member-name-link">verifyTOTP</a><wbr>(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;otpIO,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;secretIO)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Verifies the Time-based One-Time Password (TOTP) entered by the user.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(io.jmix.core.security.SystemAuthenticator)">
<h3>TOTPService</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">TOTPService</span><wbr><span class="parameters">(io.jmix.core.security.SystemAuthenticator&nbsp;systemAuthenticator)</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="onApplicationStarted(org.springframework.boot.context.event.ApplicationStartedEvent)">
<h3>onApplicationStarted</h3>
<div class="member-signature"><span class="annotations">@EventListener
</span><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">onApplicationStarted</span><wbr><span class="parameters">(org.springframework.boot.context.event.ApplicationStartedEvent&nbsp;event)</span></div>
</section>
</li>
<li>
<section class="detail" id="updateVerifier()">
<h3>updateVerifier</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">updateVerifier</span>()</div>
<div class="block">Updates the verifier for Time-based One-Time Password (TOTP) authentication.
 <p>
 This method sets the time period and time period discrepancy of the TOTP verifier
 based on the configuration settings in the TOTPAppSetting class. It logs the changes
 made to the verifier.
 </p></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list-long">
<li><code>TOTPAppSetting#setAllowedTimePeriodDiscrepancy(Integer)</code></li>
<li><code>TOTPAppSetting#setPeriod(Integer)</code></li>
<li><code>TOTPAppSetting#getAllowedTimePeriodDiscrepancy()</code></li>
<li><code>TOTPAppSetting#getPeriod()</code></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="generateSecret()">
<h3>generateSecret</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">generateSecret</span>()</div>
<div class="block">Generates a secret using the secret generator.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the generated secret.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="generateCode(de.bytestore.hostinger.entity.user.User)">
<h3>generateCode</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">dev.samstevens.totp.qr.QrData</span>&nbsp;<span class="element-name">generateCode</span><wbr><span class="parameters">(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO)</span>
                                           throws <span class="exceptions"><a href="../exception/TOTPMailUnset.html" title="class in de.bytestore.hostinger.security.exception">TOTPMailUnset</a></span></div>
<div class="block">Generates a QR code for the given user and adds it to the QR data.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>userIO</code> - the user object for which the QR code is generated</dd>
<dt>Returns:</dt>
<dd>the QR data object containing the generated QR code</dd>
<dt>Throws:</dt>
<dd><code><a href="../exception/TOTPMailUnset.html" title="class in de.bytestore.hostinger.security.exception">TOTPMailUnset</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getImageSRC(dev.samstevens.totp.qr.QrData)">
<h3>getImageSRC</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">getImageSRC</span><wbr><span class="parameters">(dev.samstevens.totp.qr.QrData&nbsp;codeIO)</span>
                   throws <span class="exceptions">dev.samstevens.totp.exceptions.QrGenerationException</span></div>
<div class="block">Retrieves the image source data of a QR code generated using the specified <code>codeIO</code> object.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>codeIO</code> - the QR data object representing the QR code</dd>
<dt>Returns:</dt>
<dd>the byte array containing the image source data</dd>
<dt>Throws:</dt>
<dd><code>dev.samstevens.totp.exceptions.QrGenerationException</code> - if there is an error in generating the QR code image</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getDataUriForImage(dev.samstevens.totp.qr.QrData)">
<h3>getDataUriForImage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">getDataUriForImage</span><wbr><span class="parameters">(dev.samstevens.totp.qr.QrData&nbsp;codeIO)</span>
                          throws <span class="exceptions">dev.samstevens.totp.exceptions.QrGenerationException</span></div>
<div class="block">Retrieves the data URI for an image generated using the specified <code>codeIO</code> object.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>codeIO</code> - the QR data object representing the QR code</dd>
<dt>Returns:</dt>
<dd>the data URI for the image</dd>
<dt>Throws:</dt>
<dd><code>dev.samstevens.totp.exceptions.QrGenerationException</code> - if there is an error in generating the QR code image</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getMimeType()">
<h3>getMimeType</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">getMimeType</span>()</div>
<div class="block">Returns the MIME type of the image generated by the <code>imageGenerator</code>.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the MIME type of the image</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="verifyTOTP(de.bytestore.hostinger.entity.user.User,java.lang.Integer)">
<h3>verifyTOTP</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">verifyTOTP</span><wbr><span class="parameters">(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;otpIO)</span></div>
<div class="block">Verifies the Time-based One-Time Password (TOTP) entered by the user.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>userIO</code> - the User object for which the TOTP is to be verified</dd>
<dd><code>otpIO</code> - the TOTP entered by the user</dd>
<dt>Returns:</dt>
<dd>true if the TOTP is valid, false otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="verifyTOTP(de.bytestore.hostinger.entity.user.User,java.lang.Integer,java.lang.String)">
<h3>verifyTOTP</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">verifyTOTP</span><wbr><span class="parameters">(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;otpIO,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;secretIO)</span></div>
<div class="block">Verifies the Time-based One-Time Password (TOTP) entered by the user.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>userIO</code> - the User object for which the TOTP is to be verified</dd>
<dd><code>otpIO</code> - the TOTP entered by the user</dd>
<dd><code>secretIO</code> - the secret associated with the TOTP (optional, can be null)</dd>
<dt>Returns:</dt>
<dd>true if the TOTP is valid, false otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="generateRecoveryCodes(de.bytestore.hostinger.entity.user.User,int)">
<h3>generateRecoveryCodes</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</span>&nbsp;<span class="element-name">generateRecoveryCodes</span><wbr><span class="parameters">(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 int&nbsp;amountIO)</span></div>
<div class="block">Generates recovery codes for a user.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>userIO</code> - the User object for which recovery codes are generated</dd>
<dd><code>amountIO</code> - the amount of recovery codes to generate</dd>
<dt>Returns:</dt>
<dd>an array of generated recovery codes</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="saveRecoveryCodes(de.bytestore.hostinger.entity.user.User,java.lang.String[],de.bytestore.hostinger.security.entity.totp.TOTPStorage)">
<h3>saveRecoveryCodes</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">saveRecoveryCodes</span><wbr><span class="parameters">(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]&nbsp;codesIO,
 <a href="../entity/totp/TOTPStorage.html" title="class in de.bytestore.hostinger.security.entity.totp">TOTPStorage</a>&nbsp;storageIO)</span></div>
<div class="block">Saves the recovery codes for a user.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>userIO</code> - The User object representing the user for which recovery codes are saved.</dd>
<dd><code>codesIO</code> - An array of recovery codes to be saved.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="verifyRecoveryCode(de.bytestore.hostinger.entity.user.User,java.lang.String)">
<h3>verifyRecoveryCode</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">verifyRecoveryCode</span><wbr><span class="parameters">(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;codeIO)</span></div>
<div class="block">Verifies the recovery code provided by the user.
 This method checks if the recovery code is valid by comparing it with the recovery codes associated with the user.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>userIO</code> - the User object for which the recovery code is to be verified</dd>
<dd><code>codeIO</code> - the recovery code provided by the user</dd>
<dt>Returns:</dt>
<dd>true if the recovery code is valid and has been successfully redeemed, false otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="hasRecoveryCode(de.bytestore.hostinger.entity.user.User,java.lang.String)">
<h3>hasRecoveryCode</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">hasRecoveryCode</span><wbr><span class="parameters">(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;codeIO)</span></div>
<div class="block">Checks if the given user has a recovery code.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>userIO</code> - the User object for which the recovery code is to be checked</dd>
<dd><code>codeIO</code> - the recovery code to check</dd>
<dt>Returns:</dt>
<dd>true if the user has the recovery code, false otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getRecoveryCodes(de.bytestore.hostinger.entity.user.User)">
<h3>getRecoveryCodes</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</span>&nbsp;<span class="element-name">getRecoveryCodes</span><wbr><span class="parameters">(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO)</span></div>
<div class="block">Retrieves the recovery codes associated with a user.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>userIO</code> - the User object for which the recovery codes are retrieved</dd>
<dt>Returns:</dt>
<dd>an array of recovery codes</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="save(de.bytestore.hostinger.entity.user.User,dev.samstevens.totp.qr.QrData)">
<h3>save</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../entity/totp/TOTPStorage.html" title="class in de.bytestore.hostinger.security.entity.totp">TOTPStorage</a></span>&nbsp;<span class="element-name">save</span><wbr><span class="parameters">(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO,
 dev.samstevens.totp.qr.QrData&nbsp;secretIO)</span></div>
<div class="block">Saves the user's information and secret for Time-based One-Time Password (TOTP) authentication.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>userIO</code> - the User object representing the user's information</dd>
<dd><code>secretIO</code> - the QrData object containing the secret for TOTP authentication</dd>
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="hasTOTP(java.lang.String)">
<h3>hasTOTP</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">hasTOTP</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;usernameIO)</span></div>
<div class="block">Checks if a user has Time-based One-Time Password (TOTP) authentication enabled.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>usernameIO</code> - the username of the user to check for TOTP authentication</dd>
<dt>Returns:</dt>
<dd>true if the user has TOTP enabled, false otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="hasTOTP(de.bytestore.hostinger.entity.user.User)">
<h3>hasTOTP</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">hasTOTP</span><wbr><span class="parameters">(<a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a>&nbsp;userIO)</span></div>
<div class="block">Checks if the given user has Time-based One-Time Password (TOTP) authentication enabled.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>userIO</code> - the User object to check for TOTP authentication</dd>
<dt>Returns:</dt>
<dd>true if the user has TOTP enabled, false otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getUserByUsername(java.lang.String)">
<h3>getUserByUsername</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../../entity/user/User.html" title="class in de.bytestore.hostinger.entity.user">User</a></span>&nbsp;<span class="element-name">getUserByUsername</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;usernameIO)</span></div>
<div class="block">Retrieves the user with the given username or email from the database.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>usernameIO</code> - the username or email of the user to retrieve</dd>
<dt>Returns:</dt>
<dd>the User object representing the retrieved user, or null if no user is found</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
